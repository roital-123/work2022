## 面试总结

### 广联达

#### 一面

- 为什么转专业？
- C++多态？在平时工作中怎么用到的？详细举例。
- 你认为什么是好的编程习惯和代码风格？
- C++怎么避免内存泄露？
- 讲述一下C++野指针的现象。
- 平时都用过什么数据结构？
- unordered_map和map底层实现，分析下两者效率？
- 简述下快排的思想，做道统计文本中单词出现次数的题（追问只遍历一遍怎么做？面试官提示用双指针）。
- 毕设做什么？追问如何使用的Z3约束求解器。
- 聊项目，主要是组态建模的实现流程（面试官说这方面和他们业务挺相关的）
- 聊本科都学过什么机械建模软件。
- 反问环节。



### 昆仑万维

#### 二面

- 代码实现strcpy，需要考虑内存重叠情况。
- LRU是用什么数据结构实现？怎么实现？
- 自旋锁和互斥锁了解吗？说下它们各自的应用场景。
- 说下C++的四种智能指针。
- 进程、线程同步都有哪几种方法？
- 指针和引用的区别。
- 反问环节。



### 大疆

#### 一面

- 聊项目，三个项目都大致聊了下但没问太深的细节。
- map和set的插入、删除时间复杂度。
- c++的模版是怎么实现的？
- 基类析构函数为什么一定要设置为虚函数？
- 你觉得你的不足之处是什么？
- 反问环节。



### 好未来

#### 一面

- 聊项目，没太细问，问了一些protobuf相关的问题，protobuf中如果一个字段没有数据，会被序列化吗？

- C++内存对齐：

  - ```c++
    // 我回答的需要占内存，所以会有1个字节，对齐会到4个字节。面试官反问为什么不是直接4个字节呢？
    class A
    {};
    // 答案是1
    
    // 我回答的对齐是4个字节
    class B: public A
    {
    public:
        bool b;
    };
    // 答案是1
    
    // 我回答的对齐是8个字节
    class C: public B
    {
    public 
        int c;
    };
    // 答案是8
    ```

- 上道题我说不考虑虚函数时的内存情况，然后面试官问怎么理解虚函数和多态，然后出了一系列的题，问输出情况：

  - 虚函数成员初始化之前，虚函数表指针初始化了吗？

    - 答案：虚函数表指针初始化是在构造函数体执行之前，和初始化列表时间点一致。

  - ```c++
    /*
    	构造函数和析构函数，调用其他虚函数时，由于虚函数表指针指向的是当前类的虚函数表，因此，调用的是当前类的函数。而这种实现，容易造成混淆和误解，所以，建议在构造函数和析构函数中应该避免直接或者间接调用其他虚函数。
    */
    class A
    {
    public:
        A(int v):m_value(v)
        {
            value();
        }
    public:
        virtual int value()
        {
            std::cout << "A::value" << std::endl;
            return m_value;
        }
    private:
        int m_value;
    };
    
    class B: public A
    {
    public:
        B():A(value())
        {
          
        }
    public:
        // 派生类虚函数的virtual关键字不需要必须加！
        int value()
        {
            std::cout << "B::value" << std::endl;
            return 0;
        }
    };
    
    int main()
    {
        // 答案是B A B 
        A* a = new B();
        a->value();
      
        return 0;
    }
    ```

  - ```c++
    /* 无虚继承的多继承构造函数调用顺序：
    		构造函数的调用顺序为：先调用所有基类的构造函数，再调用派生类中子对象类的构造函数(如派生类中的子对象)，最后调用派生类的构造函数。
        处于同一层次的各基类构造函数的调用顺序取决于派生类所指定的基类顺序，与派生类构造函数中所定义的成员初始化列表顺序无关。
    */
    
    /* 有虚继承的多继承构造函数调用顺序：
     		如果派生类有一个虚基类作为祖先类，那么在派生类构造函数的初始化列表中需要对虚基类构造函数的调用，如果未列出则表明用的是虚基类的无参数构造函数。
        不管初始化列表中次序如何，对虚基类构造函数的调用总是先于先于普通基类的构造函数。
        虚基类的唯一副本只被初始化一次。
    */
    class A
    {
    public:
         A()
         {
             std::cout << "A::A" << std::endl;
         }
    };
    
    class B
    {
    public:
        B()
        {
            std::cout << "B::B" << std::endl;
        }
    };
    
    class C: public A, virtual public B
    {
    public:
        C()
        {
            std::cout << "C:C" << std::endl;
        }
    };
    
    int main()
    {
        // 问输出顺序
        // 无虚继承时答案是A B C，有虚继承时答案是B A C
    }
    ```

- 写了道算法题，数组去重，要求空间复杂度为O(1)。

- 反问环节。表明多继承那块可以再看看。

#### 二面

- 聊项目，请求/响应怎么保证消息超时情况，为什么不直接用消息中间件的ACK来做？protobuf的特点？高效在哪？
- 数据库了解的多不多？MySQL两种引擎的数据结构分别是什么？对事务和锁的了解？MVVC的底层实现？
- 数据库B+树结构，分析单个索引的命中过程，联合索引的命中过程，多个单索引的命中过程。
- 数据库删除一个记录时，B+树的变化，效率怎么样？（树结构的平衡调整，影响其他索引对应的树结构，链表指针的调整）。
- 大文件中查找某个字符串（提示布隆过滤器和位图来做）。
- 做道算法题，统计频次。
- 反问环节。

#### 三面（HR面）

- 做项目的过程中自己最满意的一个点。
- 课题组中一个项目的具体工作是怎么展开的？老师、团队等都是怎么发挥作用的？
- 团队中意见有分歧的时候怎么解决的？
- 对互联网公司做个简单排序。
- 个人发展方向？
- 希望自己未来的公司是什么样子的？
- 自己是怎么安排相关学习提升的？
- 目前和哪些企业在沟通，拿到对应意向书了吗？
- 为什么选服务器开发这个岗位？基于什么考虑的？
- 反问环节。问了加班情况，教育双减政策会对公司有什么影响以及后续面试情况。

### 百度

#### 一面（提前批）

- 自我介绍。
- 研究生学了哪些课程？
- TCP是怎么实现可靠传输的？说了校验和、序列号机制解决乱序、确认重传机制解决丢失问题。面试官反问还有呢？不知道怎么答。
- 说下TCP的拥塞控制吧。
- 说下ARP的过程吧。
- HTTP和HTTPS有什么区别？说了下加密，面试官追问详细的加密过程，说了下依据TLS协议，使用TLS协议握手获取彼此的加密算法和证书确认之后进行加密传输。面试官继续追问用的哪个加密算法？不会。
- 说下redis。没用过。
- 说下数据库的ACID。说完后面试官追问数据库是怎么实现的ACID的？说了下事务日志，说完后面试官继续追问MVCC怎么实现的？
- 继续问数据库，问了解数据库的底层数据结构吗？说了B+树，面试官反问索引在B+树中的整个命中过程是什么样的？回答完后面试官追问sql语句什么情况下不会用到索引？能具体举例吗？后面又提示索引的最左原则。我就根据提示回答了左缀匹配的过程，面试官对这个回答不太满意，再次提示是联合索引中的最左原则，这时候才回答上了。
- 问B+树的特征，和B树什么区别？回答完后追问什么时候用B树什么时候用B+树？这个大致说了下不需要维护叶子节点链表时，也就是不需要进行范围sql时，好像没答到点上。
- 问了解什么排序？说了冒泡、快排、归并、堆都了解。反问快排的实现思路？说完后又问快排和其他排序算法相比，优点是什么？没答上来。
- 问如何判断一个链表中有环？有环的话怎么找到环的入口节点？要求证明。
- 给我介绍一个你做的项目吧。
- 项目里你觉得最难的点是什么？你是怎么解决的？
- 要求打开屏幕共享，口述了一个数据库表结构和查询需求，让手写sql。没写完整。
- 要求打开力扣，手撕一道题：最小路径和（动归）。
- 反问环节。

#### 二面

- 大文件中一堆ip地址，如何找到出现次数最多的ip地址？哈希分割？面试官追问后问题变成如何判断一个ip地址是否存在？回答布隆过滤器。面试官追问布隆过滤器有什么缺点？回答哈希冲突，不能保证ip地址一定存在。面试官又问如果内存更小怎么办？回答使用位图，将每个ip地址映射到一个位上，面试官问怎么映射？我说通过哈希函数，面试官说这里不要用哈希了，哈希会冲突，ip地址本来就可以直接映射？
  - 排序法：先归并排序，做一个外部排序，即先分割成若干个小文件载入进行内排，之后每次从小文件中抽取首行作归并即可最终获得到有序的文件。这时候再去遍历统计每个ip出现次数，并且维护最大次数即可（时间复杂度O(NlogN)，且涉及多次IO）；
  - 哈希表法：首先分割大文件成若干个小文件（可以采用哈希分割，即hash(ip)%N来选择放入哪个小文件，这样可以优先把可能相同的ip放在同一个小文件）。然后维护一个Key为ip字串，Value为该ip出现次数的HashTable（时间复杂度O(N)，涉及少量IO），在每个小文件中统计出频次，再做内排序，之后做归并思想的外排序即可（找出每个文件中出现频次最高的ip，然后再归并找到所有文件中频次最高的）。
  - 数据流中的TOP K问题可以使用小根堆解决，小数据中的TOP K问题可以使用快排的思路解决。
  - 申请512M（2的32次方个bit）的内存，一个bit位代表一个ip值。读每个ip，设置相应的bit位，读入要查询的数，查看相应bit位是否为1，为1表示存在，为0表示不存在。
- https为什么要用非对称加密和对称加密结合？非对称加密为什么比对称加密耗时？
  - 非对称加密的算法比较耗时。
- dns协议原理，工作过程，怎么配置的？我回答是手动配置的。面试官说是自动配置的，没回答上来。
  - dhcp自动配置的：ip地址、子网掩码、网关地址、dns服务器地址。
- 数据库表锁的应用场景？什么时候会变成表锁？
  - 第一种情况是：事务需要更新大部分或全部数据，表又比较大，如果使用默认的行锁，不仅这个事务执行效率低，而且可能造成其他事务长时间锁等待和锁冲突，这种情况下可以考虑使用表锁来提高该事务的执行速度。
  - 第二种情况是：事务涉及多个表，比较复杂，很可能引起死锁，造成大量事务回滚。这种情况也可以考虑一次性锁定事务涉及的表，从而避免死锁、减少数据库因事务回滚带来的开销。
    当然，应用中这两种事务不能太多，否则，就应该考虑使用ＭyISAＭ表。
- cn和com分别是什么域名？级别怎么分的？这个回答错了。
  - cn是中国国内顶级域名，com是国际顶级域名，两者应该是同级的。

#### 三面

- ps命令如何查看多核的进程运行情况？
- 一个事务如果前三条语句失败了，这时候回滚，回滚时执行undo日志中的语句又失败了，会怎么办？
- dns的查询过程，迭代和递归分别是怎么做的？
  - 递归是用户只向本地DNS服务器发出请求，然后等待肯定或否定答案。而迭代是本地服务器向根DNS服务器发出请求，而根DNS服务器只是给出下一级DNS服务器的地址，然后本地DNS服务器再向下一级DNS发送查询请求直至得到最终答案。

### 美团

#### 一面

- C11特性，聊了右值引用，问move内部做了什么？没讲明白。

  - 答：move内部只是简单做了一个类型转换，将其转换为右值引用类型，这时候再触发拷贝构造或者赋值构造时就会调用到右值引用类型参数的那个函数了。

- 编译器优化等级，说了GCC的-o的优化等级参数，面试官让举几个优化的例子，问了解RVO吗？说了下面试官说不是。

  - -O0代表关闭编译器优化选项；

  - -O1代表最基本的优化等级。编译器会在不花费太多编译时间的同时试图生成更快更小的代码；

  - -O2是-O1的进阶。这是推荐的优化等级，除非你有特殊的需求。-O2会比-O1启用多一些标记。设置了-O2后，编译器会试图提高代码性能而不会增大体积和大量占用的编译时间；

  -  -O3：这是最高最危险的优化等级。用这个选项会延长编译代码的时间，-O3生成的代码也只是比-O2快一点点而已，而gcc4.x中还未必更快。用-O3来编译所有的软件包将产生更大体积更耗内存的二进制文件，大大增加编译失败的机会或不可预知的程序行为（包括错误）；

  -  -Os：这个等级用来优化代码尺寸。其中启用了-O2中不会增加磁盘空间占用的代码生成选项。这对于磁盘空间极其紧张或者CPU缓存较小的机器非常有用。但也可能产生些许问题。

  - RVO是返回值优化，可以减少一次拷贝构造函数和析构函数的调用：

    - ```c++
      // style 1
      HeavyObject obj = func(params);
      
      // style 2：相当于把指针传进去进行构造了
      HeavyObject obj;
      func(&obj, params);
      ```

- 一个.c文件怎么变成可执行文件的？

  - 1).预处理，产生.ii文件
    2).编译，产生汇编文件(.s文件)
    3).汇编，产生目标文件(.o或.obj文件)
    4).链接,产生可执行文件(.out或.exe文件)
  - **链接主要解决的是源代码之间的相互依赖问题，链接的过程包括地址和空间的分配，符号决议，和重定位等这些步骤。**
  - **静态链接/库**
    - 在链接阶段，会将汇编生成的目标文件.o与引用到的库一起链接打包到可执行文件中，因此对应的链接方式称为静态链接。
    - 静态库可以简单看成是一组目标文件（.o/.obj文件）的集合，即很多目标文件经过压缩打包后形成的一个文件。
  - **动态链接/库**
    - 动态库在程序编译时并不会被连接到目标代码中，而是在程序运行是才被载入。 不同的应用程序如果调用相同的库，那么在内存里只需要有一份该共享库的实例，规避了空间浪费问题。动态库在程序运行时才被载入，也解决了静态库对程序的更新、部署和发布页会带来麻烦。用户只需要更新动态库即可，增量更新。动态连接解决了共享的目标文件多个副本浪费磁盘和内存空间的问题。在内存中共享一个目标文件模块的好处不仅仅是节省内存，还可以减少物理页面的换入换出，亦可以增加CPU的cache hit。
    -  动态链接也有其缺点：很常见的一个问题是，当程序所依赖的某个模块更新后，由于新的模块与旧的模块之间接口不兼容，导致原有的程序无法运行。

- 函数重载和覆盖分别是什么？C++如何实现的函数重载。

- 怎么避免内存泄露？说了智能指针，反问智能指针怎么实现的？说完后再次问内存泄漏怎么检测？有用过相关的工具吗？这个没答上来。

  - **Valgrind**：
    - Memcheck 最常用的工具，用来检测程序中出现的内存问题，所有对内存的读写都会被检测到，一切对malloc()/free()/new/delete的调用都会被捕获。所以，它能检测以下问题：
      - 对未初始化内存的使用；
      - 读/写释放后的内存块；
      - 读/写超出malloc分配的内存块；
      - 读/写不适当的栈中内存块；
      - 内存泄漏，指向一块内存的指针永远丢失；
      - 不正确的malloc/free或new/delete匹配；
      - memcpy()相关函数中的dst和src指针重叠。
  - 内存泄露工具的常见实现方法：
    - 注册内存分配/释放钩子函数(hook)。在Linux下可以malloc_hook, free_hook等5个钩子函数，在Windows下可以注册_CrtSetAllocHook钩子函数，这样在分配内存的时候就可以捕获这一请求并加以处理。Visual Leak Detecter和mtrace使用此方式。
    - 使用宏定义替换。将用户代码中的malloc, free 替换为宏定义的 mwMalloc(sz, **FILE**, **LINE**)等自定义函数，从而跟踪内存请求，memwatch即使用此方式。
    - **操作符重载。此方法仅用于C++语言中，通过重载new、delete操作符来实现跟踪内存请求，重载后的操作符类似于钩子函数意义。debug_new采用此方式**。
  - 内存泄露工具的常见检测方法：
    - **维护一个内存操作链表，当有内存申请操作时，将其加入此链表中，当有释放操作时，从申请操作从链表中移除。如果到程序结束后此链表中还有内容，说明有内存泄露了；如果要释放的内存操作没有在链表中找到对应操作，则说明是释放了多次**。使用此方法的有VC内置的调试工具，Visual Leak Detecter，mtrace, memwatch, debug_new。
    - **模拟进程的地址空间。仿照操作系统对进程内存操作的处理，在用户态下维护一个地址空间映射，**此方法要求对进程地址空间的处理有较深的理解。因为Windows的进程地址空间分布不是开源的，所以模拟起来很困难，因此只支持Linux。**采用此方法的是valgrind**。

- 进程线程说一下。然后问有写过多线程的项目吗？说了项目中用到的阻塞队列的做法，追问有了解读写锁吗？答上来之后又问了解自旋锁吗？

- 代码实现memcpy()，写完后面试官提示要考虑内存重叠，完善后又问能不能做优化？一次拷贝多个字节内存？于是我先判断了能否用int先搬多个4字节，后面再用char一次次搬剩余的1个字节，实现了优化。

- 聊无人艇项目，难点？如何解决？为什么选择这套技术栈？之后问了项目中用到的protobuf的序列化内部怎么实现的？

- 聊组态项目，问功能怎么实现的？

- 聊毕设，给了几个我可能会用到的工具，给了一些指导建议。

- 问能不能去实习？我说导师不让，面试官表示理解。

